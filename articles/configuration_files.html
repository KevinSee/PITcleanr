<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Configuration Files • PITcleanr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Configuration Files">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PITcleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/Prep_PIT_data.html">Querying, Compressing, and Making Sense of PIT Tag Detection Data</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KevinSee/PITcleanr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Configuration Files</h1>
                        <h4 data-toc-skip class="author">Kevin See</h4>
            
            <h4 data-toc-skip class="date">07 May, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KevinSee/PITcleanr/blob/main/vignettes/configuration_files.Rmd" class="external-link"><code>vignettes/configuration_files.Rmd</code></a></small>
      <div class="hidden name"><code>configuration_files.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KevinSee/PITcleanr" class="external-link">PITcleanr</a></span><span class="op">)</span></span></code></pre></div>
<p>A major part of <code>PITcleanr</code>’s functionality is mapping
detections from various antennas and sites onto user defined nodes. A
<strong>node</strong> could be an individual antenna, a row (or rows) of
antennas (i.e. an array), an entire site, or entire groups of sites.
This mapping is accomplished using a configuration file that contains
metadata about each antenna. The user can build their own (as detailed
<a href="#nonptagis">below</a>), or start with information from
PTAGIS.</p>
<div class="section level2">
<h2 id="ptagis">PTAGIS<a class="anchor" aria-label="anchor" href="#ptagis"></a>
</h2>
<p><code>PITcleanr</code> includes a function
<code><a href="../reference/queryPtagisMeta.html">queryPtagisMeta()</a></code> that queries PTAGIS for metadata about
every antenna in their system, including both interrogation and MRR
(mark, recapture, recovery) sites. Another function,
<code><a href="../reference/buildConfig.html">buildConfig()</a></code> calls <code><a href="../reference/queryPtagisMeta.html">queryPtagisMeta()</a></code>
internally, selects certain columns of data, and assigns nodes.</p>
<p>The crucial components for <code>PITcleanr</code> are (with their
column names after running <code><a href="../reference/buildConfig.html">buildConfig()</a></code>):</p>
<ul>
<li>Site Code: <code>site_code</code>
</li>
<li>Antenna ID: <code>antenna_id</code>
</li>
<li>Configuration ID: <code>config_id</code>
</li>
<li>Node: <code>node</code>
</li>
</ul>
<p>Detection data from PTAGIS contains the first three, and what “node”
those detections are mapped to can be set by the user. The configuration
ID identifies the specific arrangement of antennas during a certain
period of time. For example, if a site initially contains a single row
(i.e. array) of antennas, labeled 01, 02 and 03, but later a second row
is added (antennas 04, 05, 06), the configuration ID will change.
Sometimes the location of certain antenna (e.g. 01) changes when a site
is reconfigured, and the configuration ID helps track those changes.</p>
<p>The PTAGIS metadata also contains additional information such as:</p>
<ul>
<li>The start and end dates of that configuration:
<code>start_date</code> and <code>end_date</code>
</li>
<li>The site type (INT for interrogation and MRR for
mark/recapture/recovery): <code>site_type</code>
</li>
<li>The site name: <code>site_name</code>
</li>
<li>The name of an antenna group that an antenna is part of:
<code>antenna_group</code>
</li>
<li>The site description: <code>site_description</code>
</li>
<li>A more descriptive name for the type of site :
<code>site_type_name</code>
</li>
<li>River kilometer: <code>rkm</code>
</li>
<li>Total river kilometers to that site: <code>rkm_total</code>
</li>
<li>Latitude and longitude: <code>latitude</code> and
<code>longitude</code>
</li>
</ul>
<p>All of this would be submitted to PTAGIS by individuals when setting
up sites, and not every site will have all of that information.</p>
<p><code><a href="../reference/buildConfig.html">buildConfig()</a></code> defaults to assigning nodes based on the
array, or group of antennas (<code>node_assign = array</code>).
Searching the antenna group description for words like “upstream”,
“upper”, or “top”, it will assign those antennas to the upstream node,
which is the site code plus <code>_U</code> (e.g. <code>CHL_U</code>).
Similarly, if the antenna group description contains words like
“downstream”, “lower”, or “bottom”, it assigns it to the downstream
node, which is the site code plus <code>_D</code>. If a site contains a
middle array, those antennas are assigned to the <code>_U</code> node.
For sites with four arrays, the upper two arrays are mapped to
<code>_U</code> and the lower two arrays are mapped to
<code>_D</code>.</p>
<p>If the user chooses to set the <code>node_assign</code> argument in
<code><a href="../reference/buildConfig.html">buildConfig()</a></code> to “site”, the node will be identical to the
site code, so all detections at a site will be mapped to the same node.
If, however, the <code>node_assign</code> argument is set to “antenna”,
each antenna is defined as a separate node, and those nodes are labeled
as the site code and the antenna ID, separated by “_“.</p>
<p>Once that initial configuration file is built, the user may edit it
however they wish, either within R, or by saving it as a .csv file and
editing it by hand, then reading it back into R. Examples of this kind
of editing might include assigning all the antennas at a particular dam
to the same node, or mapping all the sites upstream (or downstream) of a
certain point to the same node, based on river kilometer or some other
criteria.</p>
<p>In the following example, we use the <code><a href="../reference/buildConfig.html">buildConfig()</a></code>
function to generate a default configuration and save it as
<code>array_configuration</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">array_configuration</span> <span class="op">=</span> <span class="fu"><a href="../reference/buildConfig.html">buildConfig</a></span><span class="op">(</span>node_assign <span class="op">=</span> <span class="st">"array"</span><span class="op">)</span></span></code></pre></div>
<p>Several sites are then consolidated into a single node (e.g. LNF,
TUM), and some mark-recovery-recapture sites are merged with upstream
array nodes, and the modified configuration is saved as
<code>my_configuration</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># customize some pieces</span></span>
<span><span class="va">my_configuration</span> <span class="op">=</span> <span class="va">array_configuration</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># first, for example, 'LNF' and 'LEAV' are re-coded into a single node 'LNF'</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'LNF'</span>, <span class="st">'LEAV'</span><span class="op">)</span>,</span>
<span>                       <span class="st">'LNF'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         <span class="co"># these three nodes are all re-coded to a single 'TUM'</span></span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TUF'</span>, <span class="st">'TUMFBY'</span>, <span class="st">'TUM'</span><span class="op">)</span>,</span>
<span>                       <span class="st">'TUM'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op">==</span> <span class="st">'CHIWAC'</span>,</span>
<span>                       <span class="st">'CHW_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CHIWAR'</span>, <span class="st">'CHIWAT'</span><span class="op">)</span>,</span>
<span>                       <span class="st">'CHL_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op">==</span> <span class="st">'CHIW'</span>,</span>
<span>                       <span class="st">'CHL_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         <span class="co"># In this case, PIT tags from carcass recoveries in the Chikamin River are</span></span>
<span>         <span class="co"># grouped with the upper 'CHU' array</span></span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op">==</span> <span class="st">'CHIKAC'</span>,</span>
<span>                       <span class="st">'CHU_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op">==</span> <span class="st">'NASONC'</span>,</span>
<span>                       <span class="st">'NAL_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op">==</span> <span class="st">'WHITER'</span>,</span>
<span>                       <span class="st">'WTL_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span>,</span>
<span>         node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">site_code</span> <span class="op">==</span> <span class="st">'LWENAT'</span>,</span>
<span>                       <span class="st">'LWN_U'</span>,</span>
<span>                       <span class="va">node</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="nonptagis">Non-PTAGIS<a class="anchor" aria-label="anchor" href="#nonptagis"></a>
</h2>
<p>For non-PTAGIS data, the user must supply their own configuration
file. This can be easily constructed in a spreadsheet or csv, making
sure to include these crucial columns (and naming them carefully):</p>
<ul>
<li>Site Code: <code>site_code</code>
</li>
<li>Antenna ID: <code>antenna_id</code>
</li>
<li>Configuration ID: <code>config_id</code>
</li>
<li>Node: <code>node</code>
</li>
</ul>
<p>For mapping purposes, or determining which sites are upstream or
downstream of one another, the user may also want to include columns for
<code>latitude</code> and <code>longitude</code>. Of course, any other
metadata the user finds useful may also be included.</p>
<p><code>PITcleanr</code> provides a template which can be used as a
starting point for building a custom configuration file. The following
code shows how to find it in the package, save it as a .csv on the
user’s desktop (or wherever they would like) and read it back into R
after the user has added all the relevant metadata to it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">config_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                          <span class="st">"configuration_template.csv"</span>, </span>
<span>                          package <span class="op">=</span> <span class="st">"PITcleanr"</span>,</span>
<span>                          mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>show_col_types <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># where will this template be saved?</span></span>
<span><span class="va">config_file</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/usernamehere/Desktop/configuration_file.csv"</span></span>
<span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">config_template</span>,</span>
<span>          <span class="va">config_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># after editing the file, read it back in</span></span>
<span><span class="va">my_configuration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">config_file</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kevin See.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
