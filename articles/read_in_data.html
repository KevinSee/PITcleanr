<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reading PIT Tag Data Into R • PITcleanr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reading PIT Tag Data Into R">
<meta property="og:description" content="PITcleanr">
<meta property="og:image" content="https://kevinsee.github.io/PITcleanr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PITcleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/Prep_PIT_data.html">Querying, Compressing, and Making Sense of PIT Tag Detection Data</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KevinSee/PITcleanr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="read_in_data_files/kePrint-0.0.1/kePrint.js"></script><link href="read_in_data_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reading PIT Tag Data Into R</h1>
                        <h4 data-toc-skip class="author">Kevin See</h4>
            
            <h4 data-toc-skip class="date">14 June, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KevinSee/PITcleanr/blob/HEAD/vignettes/read_in_data.Rmd" class="external-link"><code>vignettes/read_in_data.Rmd</code></a></small>
      <div class="hidden name"><code>read_in_data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Raw PIT tag detections contain a record of every detection of a tag code on an individual antenna, with the associate time-stamp. This data may be queried in primarily two different ways: 1) all of the tag codes detected at a site or antenna, or 2) all the detections of a particular tag code at a variety of sites or antennas. Regardless of what type of query is used, the user is generally dealing with a row of data for every single detection, identified by tag code, site, antenna and date/time (and detections may contain additional data as well).</p>
<p>This data may be stored in a variety of formats or databases. Often these can be broken out into data stored in <a href="https://ptagis.org/" class="external-link">PTAGIS</a> (The Columbia Basin PIT Tag Information System), and data stored in non-PTAGIS databases (e.g. BioLogic) or local formats (e.g. .xlsx, .txt, .log). One of the first steps in analyzing this data is to read it into R and standardize the format. <code>PITcleanr</code> contains a workhorse function, <code><a href="../reference/readCTH.html">readCTH()</a></code> (for “read complete tag history”), that can accomplish this across many data formats.</p>
</div>
<div class="section level2">
<h2 id="ptagis-data">PTAGIS Data<a class="anchor" aria-label="anchor" href="#ptagis-data"></a>
</h2>
<p>The Columbia Basin PIT Tag Information System (<a href="https://ptagis.org/" class="external-link">PTAGIS</a>) is the centralized regional database for PIT-tag detections within the Columbia River Basin. It contains a record of each detection of every PIT tag, including the initial detection, or “mark”, when the tag is implanted in the fish, detections on PIT-tag antennas, recaptures (e.g. at weirs) and recoveries (e.g. carcass surveys). It contains a record of every individual detection, which means potentially multiple records of a tag being detected on the same antenna over and over e.g., in the case that it is not moving. Therefore, querying PTAGIS for all of these detections leads to a wealth of data, which can be unwieldy for the user. <code>PITcleanr</code> aims to compress that data to a more manageable size, without losing any of the information contained in that dataset.</p>
<div class="section level3">
<h3 id="complete-capture-history">Complete Capture History<a class="anchor" aria-label="anchor" href="#complete-capture-history"></a>
</h3>
<p><code>PITcleanr</code> starts with a complete capture history query from <a href="https://ptagis.org/" class="external-link">PTAGIS</a> for a select group of tags of interest. The user will need to compile this list of tags themselves, ideally in a .txt file with one row per tag number, to make it easy to upload to a PTAGIS query.</p>
<p>For convenience, we’ve included one such file with <code>PITcleanr</code>, which is saved to the user’s computer when <code>PITcleanr</code> is installed. The file, “tag_list_TUM_2015.txt”, contains tag IDs for Chinook salmon adults implanted with PIT tags at Tumwater Dam in 2015. The following code can be used to find the path to this example file. The user can use this as a template for creating their own tag list as well.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>            <span class="st">"tag_list_TUM_2015.txt"</span>, </span>
<span>            package <span class="op">=</span> <span class="st">"PITcleanr"</span>,</span>
<span>            mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The example file of tag codes is very simple:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,019 x 1</span></span></span>
<span><span class="co">#&gt;    X1            </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 384.3B239AD241</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 3D9.1BF24B20F5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3D9.1C2D76FB78</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 3D9.1C2D770193</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 3D9.1C2D91B3DE</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 3D9.1C2D925C52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3D9.1C2D929849</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3D9.1C2D93282A</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3D9.1C2DB9A65E</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3D9.1C2DC026E4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># i 2,009 more rows</span></span></span></code></pre>
<p>Once the user has created their own tag list, or located this example one, they can go to the <a href="https:://www.ptagis/org">PTAGIS homepage</a> to query the complete tag histories for those tags. The complete tag history query is available under <a href="https://www.ptagis.org/Data/AdvancedReporting" class="external-link">Advanced Reporting</a>, which requires a free account from PTAGIS. From the <a href="https:://www.ptagis/org">homepage</a>, click on “Login/Register”, and either login to an existing account, or click “Create a new account” to create one. Once logged in, scroll down the dashboard page to the Advanced Reporting Links section. PTAGIS allows users to save reports/queries to be run again. For users who plan to utilize <code>PITcleanr</code> more than once, it saves a lot of time to build the initial query and then save it into the user’s PTAGIS account. It is then available through the “My Reports” link. To create a new query, click on “Query Builder”, or “Advanced Reporting Home Page” and then ““Create Query Builder2 Report”. From here, choose “Complete Tag History” from the list of possible reports.</p>
<p>There are several query indices on the left side of the query builder, but for the purposes of <code>PITcleanr</code> only a few are needed. First, under “1 Select Attributes” the following attributes are required to work with <code>PITcleanr</code>:</p>
<ul>
<li>Tag</li>
<li>Event Site Code</li>
<li>Event Date Time</li>
<li>Antenna</li>
<li>Antenna Group Configuration</li>
</ul>
<p>This next group of attributes are not required, but are highly recommended:</p>
<ul>
<li>Mark Species</li>
<li>Mark Rear Type</li>
<li>Event Type</li>
<li>Event Site Type</li>
<li>Event Release Site Code</li>
<li>Event Release Date Time</li>
</ul>
<p>Simply move these attributes over from the “Available” column to the “Selected:” column on the page by selecting them and clicking on the right arrow between the “Available” and “Selected” boxes. Other fields of interest to the user may be included as well (e.g. Event Length), and will be included as extra columns in the query output.</p>
<p>The only other required index is “2 Select Metrics”, but that can remain as the default, “CTH Count”, which provides one record for each event recorded per tag.</p>
<p>Set up a filter for specific tags by next navigating to the “27 Tag Code - List or Text File” on the left. After selecting “Tag” under “Attributes:”, click on “Import file…”. Simply upload the .txt file containing your PIT tag codes of interest, or alternatively, feel free to use the “tag_list_TUM_2015.txt” file provided with <code>PITcleanr</code>. After choosing the file, click on “Import” and the tag list will be loaded (delimited by semi-colons). Click “OK”.</p>
<p>Under “Report Message Name:” near the bottom, name the query something appropriate, such as “TUM_Chinook_2015”, and select “Run Report”. Once the query has successfully completed, the output can be exported as a .csv file (e.g. “TUM_Chinook_2015.csv”). Simply click on the “Export” icon near the top, which will open a new page, and select the default settings:</p>
<ul>
<li>Export: Whole report</li>
<li>CSV file format</li>
<li>Export Report Title: unchecked</li>
<li>Export filter details: unchecked</li>
<li>Remove extra column: Yes</li>
</ul>
<p>And click “Export”, again. <code>PITcleanr</code> includes an example of PTAGIS output for the Tumwater Chinook tags from 2015. Using similar code (<code>system.file</code>), the user can set the file path to this file, ans store it as a new object <code>ptagis_file</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptagis_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                          <span class="st">"TUM_Chinook_2015.csv"</span>, </span>
<span>                          package <span class="op">=</span> <span class="st">"PITcleanr"</span>,</span>
<span>                          mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, if the user has run a query from PTAGIS as described above, they could set <code>ptagis_file</code> to the path and file name of the .csv they downloaded.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># As an example, set path to PTAGIS query output</span></span>
<span><span class="va">ptagis_file</span> <span class="op">=</span> <span class="st">"C:/Users/usernamehere/Downloads/TUM_Chinook_2015.csv"</span></span></code></pre></div>
<p>Note that in our example file, there are 24938 detections (rows) for 2019 unique tags, matching the number of tags in our example tag list “tag_list_TUM_2015.txt”. For a handful of those tags, in our case 178, there is only a “Mark” detection i.e., that tag was never detected again after the fish was tagged and released. For the remaining tags, many of them were often detected at the same site and sometimes on the same antenna. Data like this, while full of information, can be difficult to analyze efficiently. To illustrate, here is an example of some of the raw data for a single tag:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Tag Code
</th>
<th style="text-align:left;">
Mark Species Name
</th>
<th style="text-align:left;">
Mark Rear Type Name
</th>
<th style="text-align:left;">
Event Type Name
</th>
<th style="text-align:left;">
Event Site Type Description
</th>
<th style="text-align:left;">
Event Site Code Value
</th>
<th style="text-align:left;">
Event Date Time Value
</th>
<th style="text-align:left;">
Antenna ID
</th>
<th style="text-align:right;">
Antenna Group Configuration Value
</th>
<th style="text-align:left;">
Event Release Site Code Code
</th>
<th style="text-align:left;">
Event Release Date Time Value
</th>
<th style="text-align:right;">
CTH Count
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:left;">
River
</td>
<td style="text-align:left;">
NASONC
</td>
<td style="text-align:left;">
11/3/2013 9:44:00 AM
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NASONC
</td>
<td style="text-align:left;">
11/4/2013 4:45:00 PM
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:14:29 AM
</td>
<td style="text-align:left;">
01
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:14:32 AM
</td>
<td style="text-align:left;">
02
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:14:35 AM
</td>
<td style="text-align:left;">
03
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:14:37 AM
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:38 AM
</td>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:38 AM
</td>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:39 AM
</td>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:39 AM
</td>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:43 AM
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:43 AM
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:43 AM
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Juvenile Fish Bypass Facility
</td>
<td style="text-align:left;">
JDJ
</td>
<td style="text-align:left;">
5/25/2014 11:15:43 AM
</td>
<td style="text-align:left;">
84
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAL
</td>
<td style="text-align:left;">
6/12/2015 1:36:38 AM
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAL
</td>
<td style="text-align:left;">
6/12/2015 1:36:50 AM
</td>
<td style="text-align:left;">
63
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAU
</td>
<td style="text-align:left;">
6/22/2015 12:40:37 AM
</td>
<td style="text-align:left;">
45
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAU
</td>
<td style="text-align:left;">
6/22/2015 12:40:55 AM
</td>
<td style="text-align:left;">
42
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAU
</td>
<td style="text-align:left;">
8/21/2015 10:17:32 PM
</td>
<td style="text-align:left;">
41
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAU
</td>
<td style="text-align:left;">
8/21/2015 10:18:13 PM
</td>
<td style="text-align:left;">
44
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
384.3B239AD241
</td>
<td style="text-align:left;">
Chinook
</td>
<td style="text-align:left;">
Wild Fish or Natural Production
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:left;">
Instream Remote Detection System
</td>
<td style="text-align:left;">
NAU
</td>
<td style="text-align:left;">
8/22/2015 12:51:37 AM
</td>
<td style="text-align:left;">
44
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p><code>PITcleanr</code> provides a function to read in this kind of complete capture history, called <code><a href="../reference/readCTH.html">readCTH()</a></code>. This function ensures the column names are consistent for subsequent <code>PITcleanr</code> functions, and provides one function to read in PTAGIS and non-PTAGIS data and return similarly formatted output.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptagis_cth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readCTH.html">readCTH</a></span><span class="op">(</span><span class="va">ptagis_file</span>,</span>
<span>                      file_type <span class="op">=</span> <span class="st">"PTAGIS"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mark-data-file">Mark Data File<a class="anchor" aria-label="anchor" href="#mark-data-file"></a>
</h3>
<p><code>PITcleanr</code> also allows the user to query PTAGIS for an MRR data file. Many projects are set up to record all the tagging information for an entire season, or part of a season from a single site in one file, which is uploaded to PTAGIS. This file can be used to determine the list of tag codes a user may be interested in. The <code>queryMRRDataFile</code> will pull this information from PTAGIS, using either the XML information contained in P4 files, or the older file structure (text file with various possible file extensions). The only requirement is the file name. For example, to pull this data for tagging at Tumwater in 2015, use the following code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tum_2015_mrr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryMRRDataFile.html">queryMRRDataFile</a></span><span class="op">(</span><span class="st">"NBD15065.TUM"</span><span class="op">)</span></span></code></pre></div>
<p>Depending on how comprehensive that MRR data file is, a user might filter this data.frame for Spring Chinook by focusing on the species run rear type of “11”, and tags that were not collected for broodstock, or otherwise killed. An example of some of the data contained in MRR files like this is shown below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tum_2015_mrr</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter for Spring Chinook tags</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">species_run_rear_type</span>, </span>
<span>                    <span class="st">"^11"</span><span class="op">)</span>,</span>
<span>         <span class="co"># filter out fish removed for broodstock collection</span></span>
<span>         <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">conditional_comments</span>,</span>
<span>                    <span class="st">"BR"</span>,</span>
<span>                    negate <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         <span class="co"># filter out fish with other mortality</span></span>
<span>         <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">conditional_comments</span>,</span>
<span>                    <span class="st">"[:space:]M[:space:]"</span>,</span>
<span>                    negate <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">conditional_comments</span>,</span>
<span>                    <span class="st">"[:space:]M$"</span>,</span>
<span>                    negate <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
sequence_number
</th>
<th style="text-align:left;">
pit_tag
</th>
<th style="text-align:left;">
species_run_rear_type
</th>
<th style="text-align:left;">
event_date
</th>
<th style="text-align:left;">
event_type
</th>
<th style="text-align:right;">
length
</th>
<th style="text-align:left;">
conditional_comments
</th>
<th style="text-align:left;">
text_comments
</th>
<th style="text-align:left;">
file_type
</th>
<th style="text-align:left;">
program_version
</th>
<th style="text-align:left;">
file_description
</th>
<th style="text-align:left;">
file_title
</th>
<th style="text-align:left;">
tag_date
</th>
<th style="text-align:left;">
tagger
</th>
<th style="text-align:left;">
migratory_yr
</th>
<th style="text-align:left;">
tag_site
</th>
<th style="text-align:left;">
capture_method
</th>
<th style="text-align:left;">
tagging_temp
</th>
<th style="text-align:left;">
release_water_temp
</th>
<th style="text-align:left;">
tagging_method
</th>
<th style="text-align:left;">
organization
</th>
<th style="text-align:left;">
coordinator_id
</th>
<th style="text-align:left;">
release_date
</th>
<th style="text-align:left;">
release_site
</th>
<th style="text-align:left;">
release_river_km
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
3D9.1C2E0410BD
</td>
<td style="text-align:left;">
11W
</td>
<td style="text-align:left;">
2015-05-10
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA1
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:left;">
3D9.1C2E0393D9
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA2
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
3D9.1C2E03B66E
</td>
<td style="text-align:left;">
11W
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT MA
</td>
<td style="text-align:left;">
DNA3
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
3D9.1C2E040410
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA4
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
3D9.1C2E091483
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA5
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
3D9.1C2E03BA01
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA6
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
3D9.1C2E038B4A
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA7
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
3D9.1C2E02E40B
</td>
<td style="text-align:left;">
11W
</td>
<td style="text-align:left;">
2015-05-12
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA8
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:left;">
3D9.1C2E045EB1
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-13
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA 9
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
<tr>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
3D9.1C2E04282A
</td>
<td style="text-align:left;">
11H
</td>
<td style="text-align:left;">
2015-05-13
</td>
<td style="text-align:left;">
Mark
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
RF MT FE
</td>
<td style="text-align:left;">
DNA20
</td>
<td style="text-align:left;">
TAGGING
</td>
<td style="text-align:left;">
PITTAG3 1.5.4
</td>
<td style="text-align:left;">
2015 TUMWATER DAM ADULT TAGGING
</td>
<td style="text-align:left;">
NBD15065.TUM
</td>
<td style="text-align:left;">
2015-03-06 14:05:00
</td>
<td style="text-align:left;">
DIETRICH N
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TUM
</td>
<td style="text-align:left;">
LADDER
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
15.0
</td>
<td style="text-align:left;">
HAND
</td>
<td style="text-align:left;">
WDFW
</td>
<td style="text-align:left;">
NBD
</td>
<td style="text-align:left;">
2015-07-30 23:59:00
</td>
<td style="text-align:left;">
TUMFBY
</td>
<td style="text-align:left;">
754.044
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="non-ptagis-data">Non-PTAGIS Data<a class="anchor" aria-label="anchor" href="#non-ptagis-data"></a>
</h2>
<p>Not all PIT tag data is in PTAGIS. This section will show the user how to read in PIT tag data from a variety of other sources, including BioLogic csv files as well as raw files (e.g. .xlsx, .log and .txt file extensions) downloaded directly from PIT tag readers. The <code><a href="../reference/readCTH.html">readCTH()</a></code> function is able to read in all of these formats, but the user must indicate what format each file is in.</p>
<p>There are many ways a user might store their various files, and many ways to script how to read them into R. In this vignette, we will suggest one way to do this, but alternatives certainly exist.</p>
<div class="section level3">
<h3 id="storing-data-files">Storing Data Files<a class="anchor" aria-label="anchor" href="#storing-data-files"></a>
</h3>
<p>In this example, we have accumulated a number of different PIT tag detection files, in a variety of formats. We have saved them all in the same folder, and used some naming convention to indicate what format they are. Files from PTAGIS have “PTAGIS” in the file name somewhere, Biologic csv files have “BIOLOGIC” in the file name somewhere, and we assume the other files are raw files (with a mixture of .xlsx, .log and .txt file extensions).</p>
<p>For raw detection files, which usually come from a single reader, the file does not contain information about what site code those observations come from. The user can add that themselves within R, or the <code><a href="../reference/readCTH.html">readCTH()</a></code> function will assume the site code is the first part of the file name before the first underscore, <code>_</code>. Therefore, if the user adopts a naming convention that includes the site code at the beginning of every raw detection file, <code>PITcleanr</code> will assign the correct site code. Otherwise, the user can overwrite the site codes manually after running <code><a href="../reference/readCTH.html">readCTH()</a></code>.</p>
<p>We set the name and path of the folder with all the detection data (<code>detection_folder</code>), and used the following script to compile a data.frame of various file names and file types. A user can set the <code>detection_folder</code> path to point to where they have stored all their detection files.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">detection_folder</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                                <span class="st">"non_ptagis"</span>,</span>
<span>                                package <span class="op">=</span> <span class="st">"PITcleanr"</span>,</span>
<span>                                mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>file_nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">detection_folder</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">file_nm</span>, <span class="st">"\\."</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>file_type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">file_nm</span>, <span class="st">"BIOLOGIC"</span><span class="op">)</span>,</span>
<span>                             <span class="st">"Biologic_csv"</span>,</span>
<span>                             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">file_nm</span>, <span class="st">"PTAGIS"</span><span class="op">)</span>,</span>
<span>                                     <span class="st">"PTAGIS"</span>,</span>
<span>                                     <span class="st">"raw"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 x 2</span></span></span>
<span><span class="co">#&gt;   file_nm                                file_type   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0LL_tagobs_BIOLOGIC_07302022.csv       Biologic_csv</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> NODENAME_01_00439.log                  raw         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PTAGIS_lemhi_remainingsites_012023.csv PTAGIS      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> SUB2_10.20.22.xlsx                     raw         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> TESTSITE_test.txt                      raw</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reading-in-detections">Reading in Detections<a class="anchor" aria-label="anchor" href="#reading-in-detections"></a>
</h3>
<p>The following script uses the path of the <code>detection_folder</code>, the various file names inside that folder, the file type associated with each file, and the <code><a href="../reference/readCTH.html">readCTH()</a></code> function to read all the detections into R and consolidate them into a single data.frame, <code>all_obs</code>. It contains a quick check (<code>try</code> and <code>"try-error"</code>) to ensure that if any particular file has trouble being read, the others are still included.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read them all in</span></span>
<span><span class="va">all_obs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">file_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>obs_df <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">file_nm</span>,</span>
<span>                       <span class="va">file_type</span>,</span>
<span>                       .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/readCTH.html">readCTH</a></span><span class="op">(</span>cth_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">detection_folder</span>, <span class="va">x</span><span class="op">)</span>, </span>
<span>                                     file_type <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>                       <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cls_obs <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="va">obs_df</span>, .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cls_obs</span> <span class="op">!=</span> <span class="st">"try-error"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">cls_obs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">obs_df</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, the user can run <code><a href="../reference/readCTH.html">readCTH()</a></code> on each detection file, saving each R object separately, and then use <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows()</a></code> to merge all the detections together. One reason to do this might be to manipulate or filter certain files before merging them.</p>
<p>The <code><a href="../reference/readCTH.html">readCTH()</a></code> also contains an argument to filter out test tags, so their detection is not included in the results. This option involves setting the <code>test_tag_prefix</code> argument to the initial alphanumeric characters in the test tags. By default, this is set to “3E7”. If the user wishes to keep all test tag detections, set <code>test_tag_prefix = NA</code>. If the user wishes to pull out <em>only</em> test tag detections, they can use the function <code><a href="../reference/readTestTag.html">readTestTag()</a></code> instead of <code><a href="../reference/readCTH.html">readCTH()</a></code>, and set the <code>test_tag_prefix</code> to the appropriate code (e.g. “3E7”).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kevin See.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
